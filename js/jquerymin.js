var winW=$(window).width();var winH=$(window).height();var page;var speed=750;var firstdivoffset=$("#intro section>div>div>div:first-child").offset().left;var firstdivW=$("#intro section>div>div").width();var firstdivend=firstdivW+firstdivoffset;var firstmask=$("#intro section>div>div>div:first-child");var scrollTop;var scrollMed;var a;var b;var closebtn;var gallerybtn;var continuebtn;var backbtn;var alerttitle;var alerttext;var alertalt;var parent;var project;var client;var date;var newurl;function menuOn(){$("#main-menu").addClass("menu-on");if(winW<=768){$("#main-menu").find("#lang, footer p").delay(350).fadeIn()}};function menuOff(){$("#main-menu").removeClass("menu-on");$("#menu-works").removeClass()};function closePageFixed(){$(".page-fixed, *[data-target*='contact'], *[data-target*='about']").removeClass("focus");if($("body").hasClass("gallery-on")){$("body, nav>ul").removeClass("contact about")}else{setTimeout(function(){$("body, nav>ul").removeClass()},600)}};function openPageFixed(){var newurl=$(location).attr('pathname')+"#"+$("#"+page).attr("id");history.pushState(null,null,newurl);if(winW>=768){$("#"+page).find(".wrapper").attr("data-mcs-theme","rounded").mCustomScrollbar()}
$("*[data-target*='"+page+"']").addClass("focus").siblings().removeClass("focus").parents("body").removeClass().addClass("no-scroll "+page).find("#"+page).addClass("focus").siblings(".page-fixed").removeClass("focus");return!1};function closeZoom(){$(".img-zoom").fadeOut();setTimeout(function(){$(".img-zoom").remove()},500)};function closeGallery(){$(".gallery").scrollTop(0).toggleClass("gallery project");$(".full").removeAttr('style').parents("body").removeClass();$("#alert").removeClass('alert-on');$('html, body').animate({scrollTop:$("#gallery").parents(".project").offset().top},speed);setTimeout(function(){$("#gallery, #alert").remove()},speed);return!1}
function reset(){$("nav li:not(li[data-target*='works']), nav ul").removeClass("focus");closeZoom();if(winW<=768){menuOff()};if($("body").hasClass("gallery-on")){closeGallery()}
history.pushState(null,null,$(location).attr('pathname'))}
function loadGallery(){var j=0;$.ajax({type:"GET",url:"Content.xml",dataType:"xml",success:function(xml){$(xml).find('project[lang*="'+$("html").attr("lang")+'"]').each(function(){var id=$(this).attr("id");var colorbg=$(this).attr('covercolor');var date=$(this).find('date').text();var client=$(this).find('client').text();var title=$(this).find('title').html();var subtitle=$(this).find('subtitle').text();var alert=$(this).attr('alert');$("#works #secret").before('<div id="'+id+'" class="full project" data-alert='+alert+'><div class="diamond-back"><div><div></div><div></div></div></div><section class="figure"><figure style="background-color:'+colorbg+'"><div><div style="background-image:url(img/'+id+'/'+id+'_cover_front.png);"></div></div></figure></section><div class="container"><section class="title"><button class="gallery-btn">'+gallerybtn+'</button><div class="data"><p class="client">'+client+'</p><p class="date">'+date+'</p></div><h1>'+title+'</h1></section></div></div>');j+=1;$("#menu-works ul li[data-target='secret']").before('<li class="anchor-target" data-target="'+id+'">'+j+'</li>')});$("#works .project").find(".title, figure, #alert button").click(function(){parent=$(this).parents(".project");project=parent.attr('id');client=parent.find(".title .client").text();date=parent.find(".title .date").text();newurl=$(location).attr('pathname')+"#"+project;eventsGallery(this)});anchortarget(this)}});return!1}
function eventsGallery(){history.pushState(null,null,newurl);menuOff();if(parent.attr("data-alert")=="on"){parent.append("<section id='alert' class='full'><section><h2 alt='"+alertalt+"'>"+alerttitle+"</h2><p>"+alerttext+"</p><footer><button onclick='alertOk(this);'>"+continuebtn+"</button><button onclick='closeGallery();'>"+backbtn+"</button></footer></section></section>");setTimeout(function(){$("#alert").addClass("alert-on")},50)}else if(parent.attr("data-alert")!="on"){$("#alert").fadeOut();$('html, body').animate({scrollTop:$("#"+project).offset().top},speed);$('#menu-works li[data-target*="'+project+'"]').siblings().removeClass("focus");$("body").removeClass().addClass("no-scroll gallery-on").find(parent).addClass("gallery").removeClass("project").scrollTop(0).find("#gallery .client").text(client).siblings(".date").text(date);setTimeout(function(){$(".gallery").css("position","fixed")},speed);$.ajax({type:"GET",url:"Content.xml",dataType:"xml",success:function(xml){var subtitle=$(xml).find('#'+project+'[lang*="'+$("html").attr("lang")+'"] subtitle').text();var content='<div id="gallery" class="wrapper"><button class="close" onclick="closeGallery()">'+closebtn+'</button><header><p>'+subtitle+'</p></header></div>';parent.find(".container").append(content);$(xml).find('#'+project+'[lang*="'+$("html").attr("lang")+'"] galerie').each(function(){var description=$(this).find('description').html();var galeriefile=$(this).attr("id");var imagemax=$(this).find('grid').text();var cover=$(this).attr("cover");if(cover!="off"&&description!=0){$("#gallery").append('<div id='+galeriefile+'><section><article>'+description+'</article><ul class="links"></ul></section><div class="cover-img"><img src="img/'+project+'/'+galeriefile+'/'+project+'_cover.'+cover+'" srcset=""></div></div>')}else if(cover!="off"&&description==0){$("#gallery").append('<div id='+galeriefile+'><div class="cover-img"><img src="img/'+project+'/'+galeriefile+'/'+project+'_cover.'+cover+'" srcset=""></div></div>')}else if(cover=="off"&&description!=0){$("#gallery").append('<div id='+galeriefile+'><section><article>'+description+'</article><ul class="links"></ul></section></div>')}else{$("#gallery").append('<div id='+galeriefile+'></div>')}
$(this).find('link').each(function(){var link=$(this).text();var linkurl=$(this).attr("href");if(linkurl!=0){$("#"+galeriefile).find(".links").append('<li><a href="'+linkurl+'" target="_blank">'+link+'</a></li>')}});if(imagemax>0){$("#"+galeriefile).append('<ul class="gallery-grid"></ul>');for(var imgs=1;imgs<=imagemax;imgs++){$("#"+galeriefile+" .gallery-grid").append("<li><img src='img/"+project+'/'+galeriefile+'/'+project+"_"+galeriefile+"_"+imgs+".jpg' alt='"+subtitle+"'/></li>")}}});$(".gallery-grid li, .cover-img").click(function(){$("main").append('<div class="img-zoom full page-fixed" onclick="closeZoom();"><button class="close">'+closebtn+'</button><img src="'+$(this).find("img").attr("src")+'"></div>')})}});$("#gallery .close").click(function(){closeGallery()});return!1}else{};return!1}
function alertOk(){$("#alert").parents(".full").attr("data-alert","off");eventsGallery(this)}
function switchIntro(){if(firstmask.width()<=0.1*firstdivW&&firstmask.hasClass("switch")){firstmask.removeClass()}else if(firstmask.width()<=0.1*firstdivW&&firstmask.attr("class")==""){firstmask.removeClass().addClass("switch")}else if(firstmask.width()>=0.9*firstdivW&&firstmask.siblings("div").hasClass("switch")){firstmask.siblings("div").removeClass()}else if(firstmask.width()>=0.9*firstdivW&&firstmask.siblings("div").attr("class")==""){firstmask.siblings("div").removeClass().addClass("switch")}};function frameAnimation(){a=Math.abs(Math.cos(scrollTop*Math.PI/winH));b=Math.abs(Math.sin(scrollTop*Math.PI/winH));if(winW>=768){var mainmenuhalf=0.5*$("#main-menu").width()+"px";$("body").css({"--width-frame":"calc("+mainmenuhalf+" - "+a.toFixed(2)*425+"px)","--height-frame-inv":(3*a).toFixed(2)+"px","--height-frame":(3-(3*a)).toFixed(2)+"px","--width-frame-cos":"calc("+mainmenuhalf+" - "+b.toFixed(2)*425+"px)","--height-frame-inv-cos":(3*b).toFixed(2)+"px","--height-frame-cos":(3-(3*b)).toFixed(2)+"px"})}};function anchortarget(){$('.anchor-target').click(function(){page=$(this).attr('data-target');reset();closePageFixed();$('html, body').animate({scrollTop:$("#"+page).offset().top},speed);return!1})};function logoTimer(){setTimeout(function(){$("#logo").removeClass("hover")},1750)}
function detectIE(){var ua=window.navigator.userAgent;var msie=ua.indexOf('MSIE ');var trident=ua.indexOf('Trident/');var edge=ua.indexOf('Edge/');if(msie>0||trident>0||edge>0){window.location.replace("http://www.cyrilconton.com/ie.html")}
return!1};$(document).ready(function(){detectIE();loadGallery();$(".page-fixed").removeClass("focus");setTimeout(function(){$('body').removeClass("loading").find("#loader").fadeOut();setTimeout(function(){$("#loader").remove()},1000);return!1},2100);if($("html").attr("lang")=="fr"){closebtn="fermer";gallerybtn="galerie";continuebtn="continuer";backbtn="retour";alerttitle="Attention";alertalt="Contenus sensibles";alerttext="Ce projet est susceptible de contenir des illustrations médicales détaillées et réalistes, voire des illustrations d'opérations chirurgicales.</br></br>Continuer?"}else{closebtn="close";gallerybtn="gallery";continuebtn="continue";backbtn="go back";alerttitle="Warning";alertalt="Sensitive content";alerttext="This project might contain detailled and realistic medical illustrations, or even illustrations of surgery.</br></br>Continue?"};if(window.history&&window.history.pushState){$(window).on('popstate',function(){reset();closePageFixed()})}
$("button.menu-toggle, #list-menu span").click(function(){if($(this).parents("#main-menu").hasClass('menu-on')){menuOff()}else{menuOn()}});$("body").keydown(function(event){$("#alert").remove();if(event.which==27&&$("main>.full:last-of-type").hasClass("img-zoom")){closeZoom()}else if(event.which==27&&$("body").hasClass("gallery-on")){closeGallery()}else if(event.which==27){menuOff();closePageFixed()}else{};return!0});anchortarget(this);$("#menu-works-trigger").click(function(){$("#menu-works").toggleClass("active")});$('main button, nav li[data-target*="about"] div, nav li[data-target*="contact"] div, #secret').click(function(){reset();if($(this).parent().is("li")){page=$(this).parents('li').attr('data-target')}else{page=$(this).attr('data-target')}
openPageFixed(this)});$('body').find('#logo, .page-fixed button.close').click(function(){closePageFixed();reset()});$("#logo").mouseenter(function(){$(this).addClass("hover");if(winW<=768){logoTimer()}});$("#logo").mouseleave(function(){$(this).removeClass("hover")});if(winW>650){$(document).mousemove(function(event){var svgW=$("li[data-target*='works'] svg").width();var svgH=$("li[data-target*='works'] svg").height();var mousecoordx=Math.round(0.08*((event.pageX*svgW/winW)-(0.65*svgW)));var mousecoordy=Math.round(0.03*((event.clientY*svgH/winH)-(svgH)));$("li[data-target*='works'].focus svg .pupille.back").attr("style","transform:translate("+mousecoordx+"%,"+mousecoordy+"%) matrix(0.75, -0.11, 0.14, 1, -2.8, 12.6) !important; transition: 0.25s ease-in-out 0.05s !important;");return!1});$("#intro section").mousemove(function(event){firstmask.width(event.pageX-firstdivoffset-50);if(event.pageX-firstdivoffset>=0.5*firstdivW){$("#intro section>div>div>span").addClass("from-left")}else{$("#intro section>div>div>span").removeClass()}}).mouseenter(function(){switchIntro()});$("#intro section div div").on("touchmove",function(e){e.preventDefault();var changedTouches=e.originalEvent.changedTouches;for(var i=0;i<changedTouches.length;i++){var touch=changedTouches[i];touchmousecoordx=touch.pageX-firstdivoffset;firstmask.width(touchmousecoordx+"px")}
if(touch.pageX-firstdivoffset>=0.5*firstdivW){$("#intro section span").addClass("from-left")}else{$("#intro section span").removeClass()}});$("#intro section div div").on("touchstart",function(e){e.preventDefault();var changedTouches=e.originalEvent.changedTouches;for(var i=0;i<changedTouches.length;i++){var touch=changedTouches[i];touchmousecoordx=touch.pageX-firstdivoffset;firstmask.width(touchmousecoordx+"px")}
switchIntro()});$("#intro section div div").on("touchend",function(e){e.preventDefault();var changedTouches=e.originalEvent.changedTouches;for(var i=0;i<changedTouches.length;i++){var touch=changedTouches[i];$("#"+touch.identifier).remove()}});$("#intro section div div").on("touchcancel",function(e){e.preventDefault();var changedTouches=e.originalEvent.changedTouches;for(var i=0;i<changedTouches.length;i++){var touch=changedTouches[i];$("#"+touch.identifier).remove()}})}});$(window).resize(function(){winW=$(window).width();winH=$(window).height();scrollTop=$(window).scrollTop();firstdivoffset=$("#intro section>div>div>div:first-child").offset().left;firstdivW=$("#intro section>div>div").width();firstdivend=firstdivW+firstdivoffset;firstmask=$("#intro section>div>div>div:first-child");frameAnimation()});$(window).scroll(function(){scrollTop=$(window).scrollTop();scrollMed=scrollTop+0.5*winH;frameAnimation();$(".full").not(".page-fixed *").each(function(){var page=$(this).attr('id');if($(".page-fixed").hasClass("focus")){}else if(scrollMed>=$(this).offset().top&&scrollMed<=$(this).offset().top+$(this).height()){$(this).addClass("focus");$('.anchor-target[data-target*="'+page+'"]').addClass("focus")}else{$(this).removeClass("focus");$('.anchor-target[data-target*="'+page+'"]').removeClass("focus")}});if(scrollMed>=winH){$("nav #list-menu li[data-target*='works']").addClass("focus")}else{$("nav #list-menu li[data-target*='works']").removeClass("focus")}})